<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seller Dashboard - Antique Auction System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #1a1a1a;
            color: #f5f5f5;
        }
        h1, h2, h3, h4 {
            font-family: 'Playfair Display', serif;
        }
        .dashboard-card {
            background-color: #2a2a2a;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .tab-button.active {
            background-color: #fbbf24;
            color: #1a1a1a;
        }
        .tab-button:not(.active):hover {
            background-color: #3a3a3a;
            color: #f5f5f5;
        }
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #ef4444;
            color: white;
            border-radius: 50%;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
        }
        .status-live { color: #22c55e; }
        .status-upcoming { color: #3b82f6; }
        .status-closed { color: #ef4444; }
        .status-leading { color: #22c55e; }
        .status-outbid { color: #ef4444; }
        .status-won { color: #fbbf24; }
        .document-status-verified { color: #22c55e; }
        .document-status-pending { color: #f59e0b; }
        .document-status-rejected { color: #ef4444; }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
            backdrop-filter: blur(2px);
            padding: 2rem 0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal-content {
            background-color: #2a2a2a;
            margin: 15% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        .modal.show {
            display: block;
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="bg-gray-900 shadow-sm py-4 px-6">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center">
                <a href="{{ url_for('auctions.auctions_home') }}" class="text-2xl font-bold text-white font-serif">Antique Auction</a>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="{{ url_for('auctions.auctions_home') }}" class="text-gray-300 hover:text-amber-400">Home</a>
                <a href="{{ url_for('auctions.auctions_home') }}#auctions" class="text-gray-300 hover:text-amber-400">Auctions</a>
                <a href="{{ url_for('auctions.category_page', category_name='All') }}" class="text-gray-300 hover:text-amber-400">Categories</a>
                <a href="{{ url_for('blog.blog_home') }}" class="text-gray-300 hover:text-amber-400">Blog</a>
                <a href="{{ url_for('auctions.about_us') }}" class="text-gray-300 hover:text-amber-400">About</a>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <i class="fas fa-bell text-gray-300 text-xl cursor-pointer hover:text-amber-400" id="notificationBell"></i>
                    <!-- <span class="notification-badge" id="notificationCount">3</span> -->
                </div>
                <button class="px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700 transition">{{ user.first_name }} {{ user.last_name }}</button>
                <a href="{{ url_for('auth.logout') }}" class="px-4 py-2 text-gray-300 hover:text-amber-600">Logout</a>
            </div>
        </div>
    </nav>
    <!-- Main Content - Seller Dashboard -->
    <main class="py-16 px-6 bg-gray-800">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl font-bold text-white mb-8">Welcome, {{ user.first_name }} (Seller)</h1>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column (Main Content) -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- 1. Add New Item Button -->
                    <div class="dashboard-card">
                        <button id="openModalBtn" class="bg-amber-600 hover:bg-amber-700 text-white text-sm py-2 px-4 rounded-md">Publish New Item</button>
                    </div>
                    <!-- Modal for Publishing New Item -->
                    <div id="itemModal" class="modal">
                        <div class="modal-content">
                            <h2 class="text-2xl font-bold text-amber-400 mb-4">Publish New Item</h2>
                            <form id="itemForm" action="{{ url_for('seller.publish_item') }}" method="POST">
                                <div class="mb-4">
                                    <label for="item-title" class="block text-gray-300 text-sm font-semibold mb-2">Item Title</label>
                                    <input type="text" id="item-title" name="title" class="w-full p-2 bg-gray-700 text-white rounded-md" required maxlength="100">
                                </div>
                                <div class="mb-4">
                                    <label for="item-category" class="block text-gray-300 text-sm font-semibold mb-2">Category</label>
                                    <select id="item-category" name="category" class="w-full p-2 bg-gray-700 text-white rounded-md" required>
                                        <option value="">Select a category</option>
                                        <option value="Timepieces">Timepieces</option>
                                        <option value="Porcelain & Ceramics">Porcelain & Ceramics</option>
                                        <option value="Furniture">Furniture</option>
                                        <option value="Jewelry">Jewelry</option>
                                        <option value="Collectibles & Memorabilia">Collectibles & Memorabilia</option>
                                        <option value="Art & Sculptures">Art & Sculptures</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label for="item-description" class="block text-gray-300 text-sm font-semibold mb-2">Description</label>
                                    <textarea id="item-description" name="description" class="w-full p-2 bg-gray-700 text-white rounded-md" required></textarea>
                                </div>
                                <div class="mb-4">
                                    <label for="item-image-url" class="block text-gray-300 text-sm font-semibold mb-2">Image URL</label>
                                    <input type="url" id="item-image-url" name="image_url" class="w-full p-2 bg-gray-700 text-white rounded-md" required maxlength="2000">
                                </div>
                                <div class="mb-4">
                                    <label for="item-condition" class="block text-gray-300 text-sm font-semibold mb-2">Condition</label>
                                    <input type="text" id="item-condition" name="condition" class="w-full p-2 bg-gray-700 text-white rounded-md" required maxlength="100">
                                </div>
                                <div class="mb-4">
                                    <label for="item-est-min" class="block text-gray-300 text-sm font-semibold mb-2">Estimated Value (Min)</label>
                                    <input type="number" id="item-est-min" name="est_min" class="w-full p-2 bg-gray-700 text-white rounded-md" required step="0.01">
                                </div>
                                <div class="mb-4">
                                    <label for="item-est-max" class="block text-gray-300 text-sm font-semibold mb-2">Estimated Value (Max)</label>
                                    <input type="number" id="item-est-max" name="est_max" class="w-full p-2 bg-gray-700 text-white rounded-md" required step="0.01">
                                </div>
                                <div class="mb-4">
                                    <label for="item-reserve-price" class="block text-gray-300 text-sm font-semibold mb-2">Reserve Price</label>
                                    <input type="number" id="item-reserve-price" name="reserve_price" class="w-full p-2 bg-gray-700 text-white rounded-md" required step="0.01">
                                </div>
                                <div class="mb-4">
                                    <label for="item-auction-end-time" class="block text-gray-300 text-sm font-semibold mb-2">Auction End Time</label>
                                    <input type="datetime-local" id="item-auction-end-time" name="auction_end_time" class="w-full p-2 bg-gray-700 text-white rounded-md" required>
                                </div>
                                <div class="mb-4">
                                    <label for="item-is-active" class="block text-gray-300 text-sm font-semibold mb-2">Active in Auction</label>
                                    <input type="checkbox" id="item-is-active" name="is_active" class="form-checkbox text-amber-600 h-5 w-5">
                                </div>

                                <div class="flex justify-end space-x-4">
                                    <button type="button" id="closeModalBtn" class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Cancel</button>
                                    <button type="submit" class="bg-amber-600 hover:bg-amber-700 text-white text-sm py-2 px-4 rounded-md">Publish</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- 2. Listed Items Section -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Your Listed Items</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {% for item in items %}
                                <div class="bg-gray-700 rounded-lg p-4 flex items-center space-x-4">
                                    <img src="{{ item.image_url }}" alt="{{ item.title }}" class="w-24 h-24 object-cover rounded-md">
                                    <div>
                                        <h3 class="text-lg font-bold text-white">{{ item.title }}</h3>
                                        <p class="text-gray-400 text-sm">Ends: {{ item.auction_end_time.strftime('%b %d, %H:%M') }}</p>
                                        <p class="text-gray-300">
                                            Current Bid: <span class="font-bold text-amber-400">₹{{ item.current_bid }}</span>
                                        </p>
                                        <p class="text-gray-300">
                                            Active: <span class="font-bold {{ 'text-green-500' if item.is_active else 'text-red-500' }}">{{ 'Yes' if item.is_active else 'No' }}</span>
                                        </p>
                                        {% if item.auction_end_time > now %}
                                            {% if item.is_active %}
                                                <span class="text-sm font-semibold status-live">Live</span>
                                            {% else %}
                                                <span class="text-sm font-semibold status-upcoming">Upcoming</span>
                                            {% endif %}
                                            <button class="mt-2 bg-gray-600 text-white text-sm py-1 px-3 rounded-md" disabled>View Bids</button>
                                        {% else %}
                                            <span class="text-sm font-semibold status-closed">Closed</span>
                                            <button class="mt-2 bg-gray-600 text-white text-sm py-1 px-3 rounded-md" disabled>Closed</button>
                                        {% endif %}
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <!-- 3. Bid History for Listed Items -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Bid History for Your Items</h2>
                        <div class="overflow-x-auto">
                            <table class="min-w-full bg-gray-700 rounded-lg">
                                <thead>
                                    <tr class="bg-gray-600 text-left text-gray-300 uppercase text-sm">
                                        <th class="py-3 px-4 rounded-tl-lg">Item</th>
                                        <th class="py-3 px-4">Bid Amount</th>
                                        <th class="py-3 px-4">Bid Time</th>
                                        <th class="py-3 px-4">Status</th>
                                        <th class="py-3 px-4 rounded-tr-lg">Active</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for bid in bids %}
                                        <tr class="border-b border-gray-600">
                                            <td class="py-3 px-4 text-white">{{ bid.item_title }}</td>
                                            <td class="py-3 px-4 text-amber-400 font-bold">₹{{ bid.bid_amount }}</td>
                                            <td class="py-3 px-4 text-gray-400">{{ bid.bid_time.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                                            <td class="py-3 px-4 font-semibold {{ 'status-live' if bid.item_auction_end_time > now and bid.item_is_active else 'status-closed' if bid.item_auction_end_time <= now else 'status-upcoming' }}">
                                                {{ 'Live' if bid.item_auction_end_time > now and bid.item_is_active else 'Closed' if bid.item_auction_end_time <= now else 'Upcoming' }}
                                            </td>
                                            <td class="py-3 px-4 {{ 'text-green-500' if bid.item_is_active else 'text-red-500' }}">{{ 'Yes' if bid.item_is_active else 'No' }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Right Column (Side Content) -->
                <div class="lg:col-span-1 space-y-8">
                    <!-- 4. Notifications Center -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Notifications</h2>
                        <div class="space-y-3">
                            <div class="flex items-start space-x-3">
                                <i class="fas fa-gavel text-amber-400 mt-1"></i>
                                <div>
                                    <p class="text-white font-semibold">New bid on "French Porcelain Vase"!</p>
                                    <p class="text-gray-400 text-sm">Current bid is ₹3,250.</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <i class="fas fa-bell text-blue-400 mt-1"></i>
                                <div>
                                    <p class="text-white font-semibold">Auction "Rare Pocket Watches" starts in 24 hours!</p>
                                    <p class="text-gray-400 text-sm">Your item is ready to go live.</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <i class="fas fa-check-circle text-green-400 mt-1"></i>
                                <div>
                                    <p class="text-white font-semibold">Payment received for "Renaissance Chest".</p>
                                    <p class="text-gray-400 text-sm">Item is being prepared for shipping.</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <i class="fas fa-file-alt text-orange-400 mt-1"></i>
                                <div>
                                    <p class="text-white font-semibold">Your KYC ID Proof is Pending Review.</p>
                                    <p class="text-gray-400 text-sm">Please allow 1-2 business days for verification.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 5. Account Information (Summary) -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Account Information</h2>
                        <div class="space-y-3 text-gray-300">
                            <p><span class="font-semibold">Name:</span> {{ user.first_name }} {{ user.last_name }}</p>
                            <p><span class="font-semibold">Email:</span> {{ user.email }}</p>
                            <p><span class="font-semibold">Phone:</span> {{ user.phone_number }}</p>
                            <p><span class="font-semibold">Address:</span> {{ user.street_address }}, {{ user.city }}, {{ user.state_province }}, {{ user.country }}</p>
                            <p><span class="font-semibold">Payment Methods:</span> {{ user.payment_methods|default("N/A") }}</p>
                        </div>
                        <div class="mt-4 flex flex-wrap gap-3">
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Edit Profile</button>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Change Password</button>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Manage Payments</button>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Download Invoices</button>
                        </div>
                    </div>
                    <!-- 6. Document Management -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Document Management</h2>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <p class="text-white">KYC ID Proof</p>
                                <span class="document-status-pending font-semibold">Pending</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <p class="text-white">Bank Account Proof</p>
                                <span class="document-status-verified font-semibold">Verified</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <p class="text-white">Business Registration</p>
                                <span class="document-status-rejected font-semibold">Rejected</span>
                            </div>
                        </div>
                        <div class="mt-4 flex flex-wrap gap-3">
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Upload New Document</button>
                            <button class="bg-gray-600 hover:bg-gray-700 text-white text-sm py-2 px-4 rounded-md">Manage Digital Signature</button>
                        </div>
                    </div>
                    <!-- 7. Support & Help -->
                    <div class="dashboard-card">
                        <h2 class="text-2xl font-bold text-amber-400 mb-4">Support & Help</h2>
                        <div class="space-y-3">
                            <a href="#" class="flex items-center text-gray-300 hover:text-amber-400">
                                <i class="fas fa-question-circle mr-3"></i> FAQs
                            </a>
                            <a href="#" class="flex items-center text-gray-300 hover:text-amber-400">
                                <i class="fas fa-book mr-3"></i> Tutorials & Guides
                            </a>
                            <a href="#" class="flex items-center text-gray-300 hover:text-amber-400">
                                <i class="fas fa-headset mr-3"></i> Contact Support
                            </a>
                            <a href="#" class="flex items-center text-gray-300 hover:text-amber-400">
                                <i class="fas fa-ticket-alt mr-3"></i> Raise a Ticket
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8 px-6 mt-8">
        <div class="max-w-7xl mx-auto text-center text-gray-400">
            <p>© 2025 Antique Auction System. All rights reserved.</p>
        </div>
    </footer>
    <script>
        // --- Real-time Updates (Simulated) ---
        const notificationCount = document.getElementById('notificationCount');
        const serverTimeDisplay = document.createElement('p');
        serverTimeDisplay.className = 'text-gray-400 text-sm mt-4 text-center';
        document.querySelector('.dashboard-card').appendChild(serverTimeDisplay);
        function updateServerTime() {
            const now = new Date();
            serverTimeDisplay.textContent = `Server Time: ${now.toLocaleTimeString()} (GMT)`;
        }
        setInterval(updateServerTime, 1000);
        updateServerTime();
        // Simulate new notification every 10 seconds
        let currentNotificationCount = parseInt(notificationCount?.textContent || 0);
        setInterval(() => {
            currentNotificationCount++;
            if (notificationCount) {
                notificationCount.textContent = currentNotificationCount;
            }
        }, 10000);
        // --- Modal Functionality ---
        const modal = document.getElementById('itemModal');
        const openModalBtn = document.getElementById('openModalBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        openModalBtn.addEventListener('click', () => {
            modal.style.display = 'block';
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        });
        closeModalBtn.addEventListener('click', () => {
            modal.style.display = 'none';
            modal.classList.remove('show');
            document.body.style.overflow = '';
        });
        window.addEventListener('click', (event) => {
            if (event.target === modal) {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
        });
        // --- Notification Bell Click ---
        const notificationBell = document.getElementById('notificationBell');
        notificationBell.addEventListener('click', () => {
            alert(`You have ${notificationCount?.textContent || 0} new notifications!`);
        });
    </script>
</body>
</html>